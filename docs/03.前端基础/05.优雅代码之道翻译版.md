---
title: 优雅代码之道翻译版
date: 2021-10-12 09:18:33
permalink: /pages/cf5eea/
sidebar: auto
categories:
  - 前端基础
tags:
  - 
---
原文地址：[clean-code-javascript](https://github.com/ryanmcdermott/clean-code-javascript)

#### 简介

![Humorous image of software quality estimation as a count of how many expletives you shout when reading code](https://pic-xiaocao123-1304191709.cos.ap-guangzhou.myqcloud.com/68747470733a2f2f7777772e6f736e6577732e636f6d2f696d616765732f636f6d6963732f7774666d2e6a7067)

​ 本文是Robert C. Martin 的《Software engineering principles》（直译软件工程原理）的JavaScript版本。这不是代码规范指导，而是教你学会编写具有可读性，可复用性和可重构的js代码。

​ 

1. 避免重复的代码

   >​ 尽量避免重复的代码。重复的代码是不好的，因为它意味着，如果你需要改变一些代码逻辑之后要更新的代码不止有一处。
   >
   >​ 想象一下，如果你经营一家餐馆，你跟踪你的库存：所有的西红柿、洋葱、大蒜、调料等等。如果你有很多个单子来记录这些库存，那么当你买掉了一个和西红柿有关的菜之后，这些单子都必须更新来达到更新库存的目的。但是如果你只有一个清单，那就只有一个地方需要更新！
   >
   >​ 很多时候，你有重复的代码是因为你有两个或更多稍有不同的东西，它们有很多共同点，但它们的差异迫使你有两个或更多的独立函数来做很多相同的事情。移除重复的代码意味着创建需要一个抽象对象，只用一个函数/模块/类就可以处理这一系列不同的事情。
   >
   >​ 构建正确的抽象对象是非常关键的，所以更应该类章节中规定的SOLID原则。糟糕的抽象可能比重复的代码更糟糕，所以要小心! 说了这么多，如果你能做出一个好的抽象，那就去做吧！不要重复自己，否则你就会被人认为是 "不合格"。不要重复自己，否则你会发现自己在任何时候想改变一件事都要更新多个地方。

❌ 不好的代码

```js
function showDeveloperList(developers) {
  developers.forEach(developer => {
    const expectedSalary = developer.calculateExpectedSalary();
    const experience = developer.getExperience();
    const githubLink = developer.getGithubLink();
    const data = {
      expectedSalary,
      experience,
      githubLink
    };

    render(data);
  });
}

function showManagerList(managers) {
  managers.forEach(manager => {
    const expectedSalary =  manager.calculateExpectedSalary();
    const experience = manager.getExperience();
    const portfolio = manager.getMBAProjects();
    const data = {
      expectedSalary,
      experience,
      portfolio
    };

    render(data);
  });
}

```

✅ 修改后

```js
function showEmployeeList(employees) {
  employees.forEach(employee => {
    const expectedSalary = employee.calculateExpectedSalary();
    const experience = employee.getExperience();

    const data = {
      expectedSalary,
      experience
    };

    switch (employee.type) {
      case "manager":
        data.portfolio = employee.getMBAProjects();
        break;
      case "developer":
        data.githubLink = employee.getGithubLink();
        break;
    }

    render(data);
  });
}

```

##### 2.使用[object.assign](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)设置默认对象值

>
>
>object.assign如果目标对象中的属性具有相同的键，则属性将被源对象中的属性覆盖。后面的源对象的属性将类似地覆盖前面的源对象的属性

- ❌ 不好的代码

```js
const menuConfig = {
  title: null,
  body: "Bar",
  buttonText: null,
  cancellable: true
};

function createMenu(config) {
  config.title = config.title || "Foo";
  config.body = config.body || "Bar";
  config.buttonText = config.buttonText || "Baz";
  config.cancellable =
    config.cancellable !== undefined ? config.cancellable : true;
}

createMenu(menuConfig);

```

- ✅ 修改后

  ```js
  const menuConfig = {
    title: "Order",
    // User did not include 'body' key
    buttonText: "Send",
    cancellable: true
  };
  
  function createMenu(config) {
    let finalConfig = Object.assign(
      {
        title: "Foo",
        body: "Bar",
        buttonText: "Baz",
        cancellable: true
      },
      config
    );
    return finalConfig
    // config now equals: {title: "Order", body: "Bar", buttonText: "Send", cancellable: true}
    // ...
  }
  
  createMenu(menuConfig);
  ```

##### 3.不要把布尔判断值当作函数参数

  >
  >
  >这意味着这个函数做的不止一件事。函数应该遵循单一原则，一个函数只做一件事。如果函数基于布尔值判断有不同的作用，就拆分它们。

  - ❌ 不好的代码

    ```js
    function createFile(name, temp) {
      if (temp) {
        fs.create(`./temp/${name}`);
      } else {
        fs.create(name);
      }
    }
    ```

  - ✅ 修改后

    ```js
    function createFile(name) {
      fs.create(name);
    }
    
    function createTempFile(name) {
      createFile(`./temp/${name}`);
    }
    
    ```
